\documentclass[../DoAn.tex]{subfiles}
\begin{document}

Chương này trình bày một cách toàn diện các lỗ hổng bảo mật 
được phát hiện trong quá trình thực hiện kiểm thử xâm nhập 
đối với hệ thống. Mỗi lỗ hổng được phân tích chi tiết dựa 
trên bản chất kỹ thuật, mức độ rủi ro bảo mật và các tác động 
tiềm ẩn đối với hệ thống. Đô án cũng cung cấp minh chứng 
khai thác nhằm làm rõ khả năng bị 
lợi dụng của lỗ hổng, đồng thời đề xuất các biện pháp khắc 
phục cụ thể để giảm thiểu rủi ro và góp phần nâng cao mức độ 
an toàn tổng thể của hệ thống lms.hust.edu.vn.

\section{Tổng quan }

Tổng cộng, đồ án đã tiến hành đánh giá bảo mật hệ thống dựa trên 10 hạng mục 
kiểm thử theo hướng dẫn của OWASP Web Security Testing Guide. Kết quả cho thấy 
9 lỗ hổng bảo mật đã được phát hiện, trong đó 3 lỗ hổng được đánh giá có mức 
độ rủi ro thấp và 6 lỗ hổng được đánh giá có mức độ rủi ro cao. Bảng dưới đây 
trình bày thông tin tổng quan về các lỗ hổng bảo mật được phát hiện trong quá trình kiểm thử.

\begin{longtable}{|>{\centering\arraybackslash}p{1cm}|>{\centering\arraybackslash}p{8cm}|>{\centering\arraybackslash}p{5cm}|}
\caption{Tổng quan các lỗ hổng}\\
\hline
\textbf{STT} & \textbf{Lỗ hổng} & \textbf{Mức độ nghiêm trọng} \\
\hline
\endfirsthead

\hline
\textbf{STT} & \textbf{Lỗ hổng} & \textbf{Mức độ nghiêm trọng} \\
\hline
\endhead

1 & Lưu trữ dữ liệu nhạy cảm trong lịch sử trình duyệt sau khi đăng xuất & Thấp \\ \hline
2 & Thiếu cơ chế bảo vệ chống tấn công Brute Force trong chức năng xác thực & Cao \\ \hline
3 & Chính sách mật khẩu yếu & Cao \\ \hline
4 & Lỗ hổng Insecure Direct Object Reference (IDOR) & Cao \\ \hline
5 & Cookie không được cấu hình thuộc tính HttpOnly & Thấp \\ \hline
6 & Lỗ hổng Stored XSS (Cross-Site Scripting) & Cao \\ \hline
7 & Lỗ hổng SQL Injection & Cao \\ \hline
8 & Lỗ hổng HTTP Request smuggling & Cao \\ \hline
9 & Hỗ trợ thuật toán mã hóa yếu trong TLS 1.2 & Thấp \\ \hline
\end{longtable}

\section{Lưu trữ dữ liệu nhạy cảm trong lịch sử trình duyệt sau khi đăng xuất}
\subsection{Đánh giá rủi ro bảo mật: Thấp}

Dựa trên phương pháp OWASP Risk Rating, lỗ hổng lưu trữ dữ liệu nhạy cảm trong lịch sử trình duyệt sau khi đăng xuất được đánh giá với hệ số khả năng khai thác là 4.625 và hệ số tác động là 0.5. Kết quả cho thấy khả năng bị khai thác ở mức trung bình trong khi mức độ tác động là thấp, do đó mức độ rủi ro tổng thể của lỗ hổng được xác định ở mức Thấp.

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/Capture1.png}
\caption{Đánh giá rủi ro bảo mật cho lỗ hổng lưu trữ dữ liệu nhạy cảm trong lịch sử trình duyệt sau khi đăng xuất}
\label{fig:Capture1}
\end{figure}

\subsection{Mô tả}
Sau khi người dùng thực hiện đăng xuất khỏi ứng dụng web, khi sử dụng chức năng “Back” (quay lại) của trình duyệt, các trang đã truy cập trước đó vẫn được hiển thị đầy đủ, bao gồm cả những trang chứa thông tin nhạy cảm như tin nhắn hoặc kết quả học tập, mặc dù người dùng tại thời điểm đó không còn ở trạng thái đăng nhập.

Trong khi đó, khi người dùng thực hiện các thao tác tương tác khác trên giao diện, hệ thống lại điều hướng đúng về trang đăng nhập để yêu cầu xác thực. Hiện tượng này cho thấy ứng dụng chỉ kiểm tra trạng thái xác thực khi phát sinh yêu cầu tải lại trang hoặc các yêu cầu AJAX (Asynchronous JavaScript and XML) mới, nhưng chưa kiểm soát hiệu quả việc hiển thị nội dung thông qua lịch sử trình duyệt và cơ chế lưu trữ tạm (cache) phía client.

\subsection{Tác động}

Lỗ hổng này có thể bị kẻ tấn công lợi dụng để truy cập 
và xem lại các thông tin nhạy cảm của người dùng trước
 đó, bao gồm thông tin cá nhân, kết quả học tập hoặc 
 các dữ liệu riêng tư khác, mà không cần thực hiện xác 
 thực lại, đặc biệt trong trường hợp thiết bị được 
 sử dụng chung hoặc bị truy cập trái phép. Điều này làm gia tăng nguy cơ rò rỉ 
 thông tin và xâm phạm quyền riêng tư của người dùng.

\subsection{Tái hiện}

Đăng nhập vào tài khoản cá nhân sau đó tiến hành xem điểm cá nhân ở trên giao diện:
\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image1.png}
\caption{Thông tin điểm cá nhân sau khi đăng nhập}
\label{fig:image2}
\end{figure}

Thực hiện đăng xuất khỏi hệ thống. Quan sát phía trên bên phải giao diện
có biểu tượng hình khóa cho thấy người dùng đã đăng xuất thành công:
\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image2.png}
\caption{Giao diện sau khi đăng xuất}
\label{fig:image2}
\end{figure}

Nhấn nút “back trên trình duyệt”, quan sát thấy vẫn trả về thông tin điểm cá nhân của người dùng trước đó:

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image1.png}
\caption{Sau khi nhấn nút "back", ứng dụng vẫn trả về thông tin điểm cá nhân}
\label{fig:image3}
\end{figure}

\subsection{Vị trí}

\begin{longtable}{|>{\centering\arraybackslash}p{1.2cm}|>{\centering\arraybackslash}p{3cm}|>{\centering\arraybackslash}p{8.3cm}|}
\caption{\centering Danh sách đường dẫn được ghi nhận cho lỗ hổng lưu trữ dữ liệu nhạy cảm trong lịch sử trình duyệt sau khi đăng xuất}\\
\hline
\textbf{\#} & \textbf{Phương thức} & \textbf{Đường dẫn} \\
\hline
\endfirsthead

\hline
\textbf{\#} & \textbf{Phương thức} & \textbf{Đường dẫn} \\
\hline
\endhead

1 & GET & https://lms.hust.edu.vn/ \\ \hline

\end{longtable}


\subsection{Phương án khắc phục}

Ứng dụng cần được cấu hình để không lưu trữ bộ nhớ đệm đối với các trang chứa thông tin nhạy cảm bằng cách thiết lập các tiêu đề HTTP phù hợp trong phản hồi, chẳng hạn như Cache-Control: no-cache, no-store, must-revalidate, nhằm ngăn chặn việc hiển thị lại nội dung sau khi người dùng đã đăng xuất, đồng thời hạn chế nguy cơ truy cập trái phép thông tin thông qua cơ chế lưu trữ tạm của trình duyệt.

Bên cạnh đó, toàn bộ ứng dụng cần được triển khai trên giao thức HTTPS nhằm đảm bảo an toàn cho quá trình truyền dữ liệu giữa client và server. Việc sử dụng HTTPS cũng góp phần nâng cao hiệu quả của các cơ chế kiểm soát bộ nhớ đệm và việc áp dụng các tiêu đề bảo mật liên quan.

Ngoài ra, phiên làm việc của người dùng cần được vô hiệu hóa đúng cách tại phía máy chủ khi thực hiện đăng xuất. Đồng thời, hệ thống phải đảm bảo tất cả các yêu cầu truy cập phát sinh sau khi đăng xuất đều được kiểm tra xác thực và tự động chuyển hướng về trang đăng nhập để yêu cầu người dùng xác thực lại.

\subsection{Tham chiếu:}
OWASP Web Security Testing Guide - WSTG-ATHN-06: Testing for Browser Cache Weaknesses

\section{Thiếu cơ chế bảo vệ chống tấn công Brute Force trong chức năng xác thực}

\subsection{Đánh giá rủi ro bảo mật: Cao}

Dựa trên phương pháp OWASP Risk Rating, lỗ hổng 
thiếu cơ chế bảo vệ chống tấn công Brute Force trong chức năng xác thực
được đánh giá với hệ số khả năng khai thác là 6.875 và hệ số tác động là 4.75. Kết quả
cho thấy lỗ hổng có khả năng bị khai thác cao và mức độ tác động ở mức trung
bình, do đó mức độ rủi ro tổng thể của lỗ hổng được xác định ở mức Cao.

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/Capture.png}
\caption{Đánh giá rủi ro bảo mật cho lỗ hổng thiếu cơ chế bảo vệ chống tấn công Brute Force trong chức năng xác thực}
\label{fig:Capture}
\end{figure}

\subsection{Mô tả}

Trong quá trình kiểm thử chức năng đăng nhập, hệ thống không triển khai các cơ chế cần thiết nhằm 
hạn chế hoặc ngăn chặn các lần thử đăng nhập không hợp lệ liên tiếp. Cụ thể, ứng dụng cho phép thực 
hiện số lượng lớn các yêu cầu đăng nhập sai mà không kích hoạt bất kỳ biện 
pháp bảo vệ nào như khóa tài khoản, giới hạn tần suất, CAPTCHA hoặc cơ chế trì hoãn phản hồi.

\subsection{Tác động}

Việc không triển khai cơ chế bảo vệ chống tấn công brute force làm suy giảm đáng kể mức độ an toàn của chức năng xác thực. Lỗ hổng này cho phép kẻ tấn công thực hiện số lượng lớn các lần thử đăng nhập nhằm đoán mật khẩu, từ đó làm gia tăng nguy cơ chiếm quyền truy cập tài khoản người dùng. Đặc biệt, đối với các tài khoản sử dụng mật khẩu yếu hoặc bị lộ thông tin xác thực từ các nguồn khác, khả năng bị khai thác là rất cao và có thể dẫn đến hậu quả nghiêm trọng về bảo mật.

Ngoài ra, việc cho phép thực hiện số lượng lớn các yêu cầu đăng nhập liên tiếp còn có thể bị lợi dụng để làm cạn kiệt tài nguyên hệ thống, dẫn đến suy giảm tính sẵn sàng của dịch vụ và gây gián đoạn quá trình truy cập của người dùng hợp lệ, ảnh hưởng đến trải nghiệm người dùng và độ ổn định chung của hệ thống.

\subsection{Tái hiện}

Thực hiện đăng nhập sai nhiều lần mà không bị chặn, quan sát phản hồi thấy 
đăng nhập thành công ở lần thứ 3425:

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/Picture5.png}
\caption{Đăng nhập thành công ở lần thứ 3425}
\label{fig:Picture5}
\end{figure}

\subsection{Vị trí}

\begin{longtable}{|>{\centering\arraybackslash}p{0.5cm}|>{\centering\arraybackslash}p{3cm}|>{\centering\arraybackslash}p{9.5cm}|}
\caption{Đường dẫn được ghi nhận là thiếu cơ chế bảo vệ chống tấn công Brute Force trong chức năng xác thực}\\
\hline
\textbf{\#} & \textbf{Phương thức} & \textbf{Đường dẫn} \\
\hline
\endfirsthead

\hline
\textbf{\#} & \textbf{Phương thức} & \textbf{Đường dẫn} \\
\hline
\endhead

1 & POST & https://sso.hust.edu.vn/adfs/ls/ \\ \hline

\end{longtable}

\subsection{Phương án khắc phục}

Để giảm thiểu nguy cơ tấn công brute force, hệ thống cần được thiết kế và triển khai một hoặc kết hợp nhiều biện pháp bảo vệ phù hợp nhằm nâng cao mức độ an toàn cho chức năng xác thực người dùng. Việc áp dụng đồng thời nhiều cơ chế bảo vệ giúp giảm đáng kể khả năng kẻ tấn công khai thác lỗ hổng thông qua các hình thức thử đoán mật khẩu tự động hoặc có chủ đích.

Cụ thể, hệ thống cần áp dụng cơ chế khóa tạm thời hoặc vô hiệu hóa tài khoản sau một số lần đăng nhập không thành công liên tiếp (thông thường từ 5 đến 10 lần), qua đó hạn chế số lượng lần thử đoán mật khẩu. Bên cạnh đó, nên triển khai cơ chế giới hạn tần suất đăng nhập (rate limiting) dựa trên tài khoản, địa chỉ IP hoặc thiết bị truy cập để ngăn chặn các yêu cầu đăng nhập với tần suất bất thường. Việc sử dụng CAPTCHA khi phát hiện nhiều lần đăng nhập thất bại liên tiếp cũng góp phần hạn chế hiệu quả của các công cụ tự động thường được sử dụng trong các cuộc tấn công brute force.

Ngoài ra, hệ thống có thể áp dụng cơ chế trì hoãn tăng dần giữa các lần thử đăng nhập nhằm kéo dài thời gian thực hiện tấn công và làm giảm khả năng khai thác thành công. Cuối cùng, cần tăng cường giám sát và ghi log các hành vi đăng nhập bất thường để phục vụ công tác phát hiện sớm, cảnh báo kịp thời và hỗ trợ quá trình phân tích, xử lý các sự cố bảo mật khi xảy ra.

\subsection{Tham chiếu}

OWASP Web Security Testing Guide - WSTG-ATHN-03: Testing for Weak Lock Out Mechanism

\section{Chính sách mật khẩu yếu}

\subsection{Đánh giá rủi ro bảo mật: Cao}

Dựa trên phương pháp OWASP Risk Rating, lỗ hổng chính sách mật khẩu yếu được đánh giá với hệ số khả năng khai thác là 6.5 và hệ số tác động là 4.0. Kết quả cho thấy lỗ hổng có khả năng bị khai thác cao và mức độ tác động ở mức trung bình, do đó mức độ rủi ro tổng thể của lỗ hổng được xác định ở mức Cao.

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/Capture2.png}
\caption{Đánh giá rủi ro bảo mật cho chính sách mật khẩu yếu}
\label{fig:Capture2}
\end{figure}

\subsection{Mô tả}
Trong chức năng đăng nhập, ứng dụng chỉ áp dụng yêu cầu tối thiểu về độ dài mật khẩu là 8 ký tự, nhưng chưa có các ràng buộc về độ phức tạp như việc bắt buộc sử dụng chữ cái in hoa, chữ cái thường, chữ số hoặc ký tự đặc biệt. Bên cạnh đó, trong chức năng thay đổi mật khẩu, hệ thống vẫn cho phép người dùng thiết lập mật khẩu mới trùng với mật khẩu cũ, dẫn đến việc không đảm bảo cải thiện mức độ an toàn của thông tin xác thực.

\subsection{Tác động}
Việc áp dụng chính sách mật khẩu chưa đủ mạnh làm gia tăng khả năng mật khẩu của người dùng bị dò đoán hoặc khai thác thành công, đặc biệt trong các kịch bản tấn công như brute-force hoặc credential stuffing. Điều này làm tăng nguy cơ tài khoản người dùng bị chiếm đoạt, dẫn đến khả năng rò rỉ dữ liệu, truy cập trái phép vào hệ thống và phát sinh các rủi ro bảo mật nghiêm trọng khác.

\subsection{Tái hiện}

Ứng dụng cho phép người dùng đăng nhập thành công với các mật khẩu có độ phức tạp thấp, chẳng hạn như mật khẩu dạng chuỗi số đơn giản (ví dụ như 12345678), cho thấy chính sách mật khẩu hiện tại chưa được thiết lập và thực thi chặt chẽ:
\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image4_1.png}
\caption{Cho phép đăng nhập với mật khẩu yếu}
\label{fig:image4_1}
\end{figure}

Chức năng thay đổi mật khẩu cho phép người dùng thiết lập mật khẩu mới trùng với mật khẩu đã sử dụng trước đó, cho thấy cơ chế quản lý lịch sử mật khẩu chưa được áp dụng hoặc chưa được kiểm soát hiệu quả:
\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image5_1.png}
\caption{Cho phép đặt lại mật khẩu mới trùng với mật khẩu cũ}
\label{fig:image5_1}
\end{figure}

\subsection{Vị trí}

\begin{longtable}{|>{\centering\arraybackslash}p{0.5cm}|>{\centering\arraybackslash}p{3cm}|>{\centering\arraybackslash}p{9.5cm}|}
\caption{Đường dẫn được ghi nhận cho chính sách mật khẩu yếu}\\
\hline
\textbf{\#} & \textbf{Phương thức} & \textbf{Đường dẫn} \\
\hline
\endfirsthead

\hline
\textbf{\#} & \textbf{Phương thức} & \textbf{Đường dẫn} \\
\hline
\endhead

1 & POST & https://sso.hust.edu.vn/adfs/portal/updatepassword \\ \hline

\end{longtable}


\subsection{Phương án khắc phục}

Ứng dụng cần áp dụng chính sách mật khẩu mạnh và nhất quán, bao gồm các yêu cầu về độ phức tạp, thời hạn sử dụng và khả năng tái sử dụng mật khẩu. Cụ thể, hệ thống nên quy định rõ độ dài tối thiểu và tối đa của mật khẩu nhằm đảm bảo mức độ an toàn cần thiết. Đồng thời, cần thiết lập cơ chế kiểm soát lịch sử mật khẩu để hạn chế việc sử dụng lại các mật khẩu đã từng được dùng trước đó, bao gồm việc xác định số lần đổi mật khẩu tối thiểu hoặc khoảng thời gian cần thiết trước khi cho phép tái sử dụng một mật khẩu cũ.

Bên cạnh đó, ứng dụng cần ngăn chặn việc sử dụng các mật khẩu phổ biến hoặc dễ suy đoán bằng cách kiểm tra và loại bỏ các mật khẩu có chứa các thông tin liên quan trực tiếp đến người dùng hoặc hệ thống, chẳng hạn như tên ứng dụng, tên đơn vị, tên miền hoặc tên người dùng. Việc kiểm tra này có thể được thực hiện thông qua cơ chế chuẩn hóa mật khẩu về dạng chữ thường và so sánh với danh sách các mật khẩu phổ biến trước khi chấp nhận sử dụng.

Ngoài ra, chính sách mật khẩu cần được áp dụng đồng nhất trên toàn bộ các chức năng liên quan đến xác thực, bao gồm tạo tài khoản, thay đổi mật khẩu và khôi phục mật khẩu, nhằm đảm bảo tính nhất quán và giảm thiểu nguy cơ phát sinh các điểm yếu bảo mật trong hệ thống.

\subsection{Tham chiếu:} 

OWASP Web Security Testing Guide - WSTG-ATHN-07: Testing for Weak Authentication Methods

\section{Lỗ hổng Insecure Direct Object References (IDOR)}

\subsection{Đánh giá rủi ro bảo mật: Cao}

Dựa trên phương pháp OWASP Risk Rating, lỗ hổng Insecure Direct Object References (IDOR) được đánh giá với hệ số khả năng khai thác là 6.25 và hệ số tác động là 3.25. Kết quả cho thấy lỗ hổng có khả năng bị khai thác cao và mức độ tác động ở mức trung bình, do đó mức độ rủi ro tổng thể của lỗ hổng được xác định ở mức Cao.

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/Capture3.png}
\caption{Đánh giá rủi ro bảo mật cho lỗ hổng IDOR}
\label{fig:Capture3}
\end{figure}

\subsection{Mô tả}

Chức năng Linked Logins tồn tại lỗ hổng Insecure Direct Object Reference (IDOR), cho phép người dùng thực hiện thao tác xóa liên kết tài khoản thông qua việc cung cấp trực tiếp giá trị linkedLoginId mà không có cơ chế xác thực hoặc kiểm tra quyền sở hữu tương ứng. Lỗ hổng này phát sinh do hệ thống chưa triển khai đầy đủ các biện pháp kiểm soát truy cập ở phía máy chủ đối với các đối tượng dữ liệu nhạy cảm.

Cụ thể, mỗi tài khoản trong hệ thống được gán một giá trị linkedLoginId duy nhất và API dùng để xóa liên kết tài khoản chỉ dựa trên tham số này để xác định đối tượng cần xử lý. Tuy nhiên, trong quá trình tiếp nhận và xử lý yêu cầu, hệ thống không thực hiện kiểm tra để xác minh rằng giá trị linkedLoginId được gửi trong request thực sự thuộc quyền sở hữu của người dùng đang đăng nhập hoặc có quyền thao tác hợp lệ trên đối tượng đó.

Do đó, người dùng có thể thao túng tham số linkedLoginId trong yêu cầu API nhằm 
hủy liên kết tài khoản của các người dùng khác trong hệ thống. Hành vi này có thể 
dẫn đến nguy cơ truy cập trái phép, làm gián đoạn hoạt động liên kết tài khoản hợp 
lệ.

\subsection{Tác động}

Lỗ hổng này chủ yếu ảnh hưởng đến tính sẵn sàng của hệ thống, do cho phép kẻ tấn công hủy liên kết tài khoản của người dùng khác, dẫn đến việc gián đoạn khả năng đăng nhập và truy cập dịch vụ trong một khoảng thời gian nhất định. Ngoài ra, việc thay đổi trái phép trạng thái liên kết tài khoản cũng có thể gây ảnh hưởng gián tiếp đến tính toàn vẹn của dữ liệu người dùng.

\subsection{Tái hiện}

POC: Dùng tài khoản Quoc.BA gỡ liên kết tài khoản của Anh.NT

Tài khoản Quoc.BA có Session là kfns6djglskf8de2qi9sptptc5:

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image6_1.png}
\caption{Session của tài khoản Quoc.BA}
\label{fig:image6_1}
\end{figure}

Tài khoản Anh.NT có Session là dm13idcbosk7inlnkutgimfmv6:

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image7_1.png}
\caption{Session của tài khoản Anh.NT}
\label{fig:image7_1}
\end{figure}

Tài khoản Anh.NT có Linkedloginid=28004:

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image8_1.png}
\caption{Linkedloginid của tải khoản Anh.NT}
\label{fig:image8_1}
\end{figure}

Sử dụng tài khoản Quoc.BA gỡ tài khoản liên kết của tài khoản Anh.NT bằng cách gửi yêu cầu xóa liên kết có kèm id trong tham số:

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image9.png}
\caption{Sử dụng tài khoản Quoc.BA gỡ tài khoản liên kết của tài khoản Anh.NT}
\label{fig:image9}
\end{figure}

Kiểm tra bên tài khoản Anh.NT thì liên kết đã bị xóa:

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image10.png}
\caption{Liên kết của tài khoản Anh.NT đã bị xóa}
\label{fig:image10}
\end{figure}

\subsection{Vị trí}

\begin{longtable}{|>{\centering\arraybackslash}p{0.5cm}|>{\centering\arraybackslash}p{3cm}|>{\centering\arraybackslash}p{10.5cm}|}
\caption{\centering Danh sách đường dẫn được ghi nhận cho lỗ hổng IDOR}\\
\hline
\textbf{\#} & \textbf{Phương thức} & \textbf{Đường dẫn} \\
\hline
\endfirsthead

\hline
\textbf{\#} & \textbf{Phương thức} & \textbf{Đường dẫn} \\
\hline
\endhead

1 & GET & https://lms.hust.edu.vn/auth/oauth2/linkedlogins.php \\ \hline

\end{longtable}

\subsection{Phương án khắc phục}

Để khắc phục lỗ hổng Insecure Direct Object Reference (IDOR), hệ thống cần thực hiện kiểm soát truy cập chặt chẽ ở phía máy chủ bằng cách xác thực quyền sở hữu đối tượng trước khi cho phép thực hiện bất kỳ thao tác nào liên quan đến dữ liệu người dùng. Cụ thể, khi xử lý yêu cầu xóa liên kết tài khoản, máy chủ phải kiểm tra và đảm bảo rằng giá trị linkedLoginId được gửi trong yêu cầu thực sự thuộc quyền sở hữu của người dùng đang đăng nhập, thay vì chỉ dựa vào tham số được cung cấp từ phía client. Việc kiểm tra này cần được thực hiện nhất quán đối với tất cả các API liên quan đến thao tác trên đối tượng.

Bên cạnh đó, hệ thống nên sử dụng các định danh nội bộ khó đoán, chẳng hạn như UUID hoặc các giá trị đã được băm, thay vì sử dụng các định danh dạng tăng dần hoặc có thể suy đoán. Việc áp dụng các định danh này giúp giảm khả năng kẻ tấn công thực hiện liệt kê hoặc đoán các giá trị hợp lệ, từ đó hạn chế đáng kể nguy cơ khai thác lỗ hổng IDOR. Ngoài ra, cần kết hợp cơ chế kiểm soát truy cập dựa trên người dùng hoặc vai trò để đảm bảo mỗi thao tác chỉ được thực hiện bởi các chủ thể có quyền hợp lệ.

\subsection{Tham chiếu:}
OWASP Web Security Testing Guide - WSTG-ATHZ-04: Testing for Insecure Direct Object References

\section{Cookie không được cấu hình thuộc tính HttpOnly}

\subsection{Đánh giá rủi ro bảo mật: Thấp}

Dựa trên phương pháp OWASP Risk Rating, lỗ hổng cookie không được cấu hình thuộc tính HttpOnly được đánh giá với hệ số khả năng khai thác là 4.125 và hệ số tác động là 1.00. Kết quả này cho thấy khả năng bị khai thác của lỗ hổng ở mức trung bình, trong khi mức độ tác động được đánh giá là thấp, do dữ liệu bị ảnh hưởng chủ yếu giới hạn trong phạm vi thông tin phiên.

Trên cơ sở đó, mức độ rủi ro tổng thể của lỗ hổng được xác định ở mức 
Thấp theo thang đánh giá của OWASP. Tuy nhiên, lỗ hổng này vẫn cần được 
lưu ý, đặc biệt khi kết hợp với các lỗ hổng khác như Cross-Site Scripting (XSS), có thể làm gia tăng mức độ ảnh hưởng đối với an toàn thông tin của người dùng.

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/Capture4.png}
\caption{Đánh giá rủi ro bảo mật cho Cookie không được cấu hình thuộc tính HttpOnly}
\label{fig:Capture4}
\end{figure}


\subsection{Mô tả}

Ứng dụng sử dụng cookie cho mục đích xác thực người dùng nhưng chưa cấu hình đầy đủ các thuộc tính 
bảo mật cần thiết, cụ thể là thiếu thuộc tính HttpOnly. 

\subsection{Tác động}

Cookie xác thực có thể bị truy cập và đánh cắp thông qua các hình thức tấn công phía client, chẳng hạn như Cross-Site Scripting (XSS), từ đó dẫn đến nguy cơ chiếm quyền phiên làm việc của người dùng và phát sinh các rủi ro bảo mật liên quan.

\subsection{Tái hiện}

Cookie được sử dụng để xác thực người dùng nhưng chưa được cấu hình thuộc tính HttpOnly

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image11.png}
\caption{Cookie của người dùng không có cờ HttpOnly: true}
\label{fig:image11}
\end{figure}

\subsection{Vị trí}

\begin{longtable}{|>{\centering\arraybackslash}p{0.5cm}|>{\centering\arraybackslash}p{3cm}|>{\centering\arraybackslash}p{10.5cm}|}
\caption{Danh sách đường dẫn được ghi nhận cho Cookie không có cờ HttpOnly}\\
\hline
\textbf{\#} & \textbf{Phương thức} & \textbf{Đường dẫn} \\
\hline
\endfirsthead

\hline
\textbf{\#} & \textbf{Phương thức} & \textbf{Đường dẫn} \\
\hline
\endhead

1 & GET & https://lms.hust.edu.vn/ \\ \hline

\end{longtable}

\subsection{Phương án khắc phục}

Cookie cần được thiết lập đầy đủ các thuộc tính bảo mật, bao gồm HttpOnly để ngăn truy cập từ mã 
phía client, Secure để đảm bảo cookie chỉ được truyền qua kết nối HTTPS, và SameSite nhằm hạn chế 
nguy cơ tấn công CSRF.

\subsection{Tham chiếu:}
OWASP Web Security Testing Guide - WSTG-SESS-02: Testing for Cookies Attributes

\section{Lỗ hổng Stored XSS (Cross-Site Scripting)}

\subsection{Đánh giá rủi ro bảo mật: Cao}

Dựa trên phương pháp OWASP Risk Rating, lỗ hổng Stored Cross-Site Scripting (XSS) được đánh giá với hệ số khả năng khai thác là 6.125 và hệ số tác động là 5.0. Kết quả cho thấy lỗ hổng có khả năng bị khai thác cao và mức độ tác động ở mức trung bình, do đó mức độ rủi ro tổng thể của lỗ hổng được xác định ở mức Cao.

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/Capture5.png}
\caption{Đánh giá rủi ro bảo mật cho lỗ hổng Stored XSS}
\label{fig:Capture5}
\end{figure}


\subsection{Mô tả}

Ứng dụng tồn tại lỗ hổng Stored Cross-Site Scripting (Stored XSS) trong chức 
năng tạo và hiển thị sự kiện trên trang Lịch. Cụ thể, dữ liệu người dùng nhập 
vào trường Label của sự kiện không được kiểm tra, lọc bỏ hoặc mã hóa an 
toàn trước khi được lưu trữ và hiển thị lại trên trình duyệt.

\subsection{Tác động}

Lỗ hổng Stored Cross-Site Scripting (XSS) cho phép kẻ tấn công chèn và lưu trữ mã JavaScript độc hại trên hệ thống, từ đó thực thi mã này trong trình duyệt của người dùng khi họ truy cập vào trang lịch chứa nội dung bị chèn. Do payload được lưu trữ phía máy chủ, mọi người dùng truy cập vào trang bị ảnh hưởng đều có nguy cơ trở thành nạn nhân mà không cần tương tác thêm.

Trong trường hợp này, cookie phiên của ứng dụng không được cấu hình thuộc tính HttpOnly, khiến dữ liệu xác thực có thể bị truy cập trực tiếp thông qua JavaScript phía client. Kẻ tấn công có thể lợi dụng lỗ hổng này để đánh cắp cookie phiên và gửi ra ngoài máy chủ do chúng kiểm soát, từ đó chiếm quyền truy cập tài khoản người dùng. Hậu quả có thể dẫn đến việc lộ thông tin cá nhân, thực hiện các hành vi trái phép dưới danh nghĩa nạn nhân và ảnh hưởng nghiêm trọng đến an toàn thông tin của hệ thống.

\subsection{Tái hiện}

Truy cập trang Lịch để tạo sự kiện: https://lms.hust.edu.vn/calendar/view.php.

Chọn một ngày và Tạo sự kiện mới:

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image12.png}
\caption{Giao diện tạo sự kiện mới}
\label{fig:image12}
\end{figure}

Chèn Media: Trong phần Description (Mô tả) của lịch sự kiện, chọn Insert Video.
Sau đó chọn tùy chọn chèn Audio/Video:

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image13_1.png}
\caption{Tạo sự kiện mới}
\label{fig:image13_1}
\end{figure}

Tìm đến phần Subtitles and Captions. Tìm đến trường Label để chèn payload Cross-Site Scripting:

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image14_1.png}
\caption{Chọn tùy chọn chèn Audio/Video}
\label{fig:image14_1}
\end{figure}

Ví dụ payload đã chèn để lấy cookie ra webhook:

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image15_1.png}
\caption{Chèn payload XSS trong trường Label}
\label{fig:image15_1}
\end{figure}

Khi người dùng truy cập trang, cookie người dùng sẽ tự động được gửi 
ra ngoài vào webhook (Vì không có HttpOnly):

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image16.png}
\caption{Khi người dùng load phải trang, cookie người dùng sẽ tự động được gửi ra ngoài vào webhook}
\label{fig:image16}
\end{figure}

Truy cập vào webhook, quan sát đã lấy được cookie:

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image17_1.png}
\caption{Lấy cookie thành công trên webhook}
\label{fig:image17_1}
\end{figure}


\textbf{Vị trí}:

\begin{longtable}{|>{\centering\arraybackslash}p{0.5cm}|>{\centering\arraybackslash}p{3cm}|>{\centering\arraybackslash}p{10.5cm}|}
\caption{Danh sách đường dẫn được ghi nhận cho lỗ hổng Stored XSS}\\
\hline
\textbf{\#} & \textbf{Phương thức} & \textbf{Đường dẫn} \\
\hline
\endfirsthead

\hline
\textbf{\#} & \textbf{Phương thức} & \textbf{Đường dẫn} \\
\hline
\endhead

1 & POST & https://lms.hust.edu.vn/calendar/view.php \\ \hline

\end{longtable}

\subsection{Phương án khắc phục}

Hệ thống cần thực hiện kiểm tra và làm sạch toàn bộ dữ liệu đầu vào do người dùng cung cấp trước khi lưu trữ hoặc xử lý, nhằm loại bỏ các thẻ HTML, thuộc tính và cú pháp nguy hiểm có khả năng thực thi mã JavaScript. Việc kiểm tra dữ liệu đầu vào cần được triển khai nhất quán tại phía máy chủ, thay vì chỉ dựa vào cơ chế kiểm soát phía client, để đảm bảo không thể bị bỏ qua hoặc thao túng. Đồng thời, nên áp dụng các danh sách cho phép (whitelist) đối với các thẻ và định dạng hợp lệ nhằm giảm thiểu nguy cơ chèn mã độc.

Bên cạnh đó, dữ liệu được hiển thị trên trình duyệt cần được mã hóa đầu ra (output encoding) theo đúng ngữ cảnh sử dụng, chẳng hạn như HTML, JavaScript, URL hoặc thuộc tính HTML, để đảm bảo nội dung không bị diễn giải và thực thi dưới dạng mã lệnh. Việc mã hóa đầu ra giúp ngăn chặn các payload XSS ngay cả trong trường hợp dữ liệu độc hại đã được lưu trữ trong hệ thống.

Ngoài ra, cookie phiên cần được cấu hình đầy đủ các thuộc tính bảo mật như HttpOnly, Secure và SameSite để hạn chế khả năng truy cập cookie từ JavaScript phía client và ngăn chặn việc gửi cookie qua các kết nối không an toàn. Điều này giúp giảm thiểu tác động của lỗ hổng XSS trong trường hợp kẻ tấn công chèn được mã độc thành công.

Bên cạnh các biện pháp trên, cần thường xuyên rà soát, kiểm thử bảo mật và cập nhật các thư viện, framework đang sử dụng để đảm bảo tuân thủ các khuyến nghị bảo mật hiện hành.

\subsection{Tham chiếu:}
OWASP Web Security Testing Guide - WSTG-INPV-02: Testing for Stored Cross Site Scripting

\section{Lỗ hổng SQL Injection}

\subsection{Đánh giá rủi ro bảo mật: Cao}

Dựa trên phương pháp OWASP Risk Rating, lỗ hổng SQL Injection được đánh giá với hệ số khả năng khai thác là 6.125 và hệ số tác động là 5.75. Kết quả cho thấy lỗ hổng có khả năng bị khai thác cao và mức độ tác động ở mức trung bình, do đó mức độ rủi ro tổng thể của lỗ hổng được xác định ở mức Cao.

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/Capture6.png}
\caption{Đanh giá rủi ro bảo mật cho lỗ hổng SQL Injection}
\label{fig:Capture6}
\end{figure}

\subsection{Mô tả}

Ứng dụng tồn tại lỗ hổng SQL Injection (Blind/Time-based) tại tham số sort trong request 
được gửi từ chức năng Dashboard. Do giá trị của sort được đưa trực tiếp vào câu truy vấn 
SQL mà không được kiểm soát, kẻ tấn công có thể chèn ký tự đặc biệt để làm 
thay đổi cú pháp truy vấn. 

\subsection{Tác động}

Lỗ hổng SQL Injection cho phép kẻ tấn công xác định và liệt kê tên các bảng trong cơ sở dữ liệu thông qua kỹ thuật suy luận. Mặc dù tại thời điểm kiểm thử chưa thể truy xuất trực tiếp nội dung dữ liệu, việc lộ cấu trúc cơ sở dữ liệu đã cung cấp thông tin quan trọng về cách tổ chức, mối quan hệ giữa các bảng và các thành phần bên trong hệ thống.

Những thông tin này có thể được sử dụng làm bước đệm cho các kịch bản tấn công nâng cao hơn trong trường hợp lỗ hổng không được khắc phục kịp thời, chẳng hạn như mở rộng khai thác để đọc dữ liệu nhạy cảm, kết hợp với các lỗ hổng khác hoặc hỗ trợ quá trình phân tích sâu kiến trúc hệ thống. Do đó, lỗ hổng này tiềm ẩn rủi ro đối với tính bảo mật tổng thể của ứng dụng và cần được ưu tiên xử lý sớm nhằm hạn chế khả năng bị khai thác trong thực tế.

\subsection{Tái hiện}

Truy cập chức năng Dashboard ta có được request như sau:

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image19.png}
\caption{Truy cập vào chức năng Dashboard trên giao diện}
\label{fig:image19}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image20.png}
\caption{Request gửi từ chức năng Dashboard}
\label{fig:image20}
\end{figure}

Qua phân tích, nhận thấy tham số sort trong request có dấu hiệu không được 
kiểm soát chặt chẽ. Cụ thể, khi truyền ký tự đặc biệt như dấu chấm phẩy 
(;) vào tham số sort, phản hồi từ server thay đổi bất thường:

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image21_1.png}
\caption{Chèn dấu chấm phẩy vào tham số sort}
\label{fig:image21_1}
\end{figure}

Khi bổ sung ký tự comment (--) để vô hiệu hóa phần truy vấn phía sau, 
ứng dụng hoạt động trở lại bình thường, cho thấy tham số này được chèn 
trực tiếp vào câu truy vấn SQL:

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image22_1.png}
\caption{Chèn ký tự comment vào tham số sort}
\label{fig:image22_1}
\end{figure}

Tiếp tục thử nghiệm với payload SQL Injection theo hướng time-based, 
phản hồi từ server xuất hiện độ trễ rõ rệt (khoảng 5 giây), xác nhận sự 
tồn tại của lỗ hổng SQL Injection tại tham số sort:

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image23_1.png}
\caption{Chèn payload time-based vào tham số sort}
\label{fig:image23_1}
\end{figure}

Dựa vào kỹ thuật trên, có thể xác định được độ dài tên database thông qua sự khác biệt về 
thời gian phản hồi:

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image24_1.png}
\caption{Chèn payload xác định độ dài database vào tham số sort}
\label{fig:image24_1}
\end{figure}

Từ kết quả trên, tiến hành kiểm tra sự tồn tại của các bảng trong 
cơ sở dữ liệu bằng cách chèn các truy vấn kiểm chứng. Khi cung cấp tên 
bảng hợp lệ, ứng dụng trả về phản hồi bình thường; ngược lại, với tên bảng 
không tồn tại, hệ thống phát sinh lỗi:

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image25_1.png}
\caption{Ứng dụng trả về phản hồi bình thường nếu tên bảng đúng}
\label{fig:image25_1}
\end{figure}


\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image26_1.png}
\caption{Ứng dụng trả về phản hồi lỗi nếu tên bảng sai}
\label{fig:image26_1}
\end{figure}

Cuối cùng, sử dụng công cụ tự động hóa để lần lượt gửi các payload tương 
ứng, qua đó liệt kê được danh sách tên các bảng trong cơ sở dữ liệu như ảnh sau.

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image27.png}
\caption{Liệt kê thành công các bảng trong cơ sở dữ liệu}
\label{fig:image27}
\end{figure}

\subsection{Vị trí}

\begin{longtable}{|>{\centering\arraybackslash}p{0.5cm}|>{\centering\arraybackslash}p{3cm}|>{\centering\arraybackslash}p{10.5cm}|}
\caption{Danh sách đường dẫn được ghi nhận cho lỗ hổng SQL Injection}\\
\hline
\textbf{\#} & \textbf{Phương thức} & \textbf{Đường dẫn} \\
\hline
\endfirsthead

\hline
\textbf{\#} & \textbf{Phương thức} & \textbf{Đường dẫn} \\
\hline
\endhead

1 & POST & https://lms.hust.edu.vn/lib/ajax/service.php \\ \hline

\end{longtable}

\subsection{Phương án khắc phục}
Không ghép trực tiếp dữ liệu đầu vào của người dùng vào câu truy vấn SQL. 
Ứng dụng cần sử dụng truy vấn tham số hóa để đảm bảo 
dữ liệu đầu vào không làm thay đổi cú pháp truy vấn.

Đối với tham số sort, cần giới hạn giá trị hợp lệ theo whitelist 
(chỉ cho phép các trường sắp xếp đã được định nghĩa sẵn) và từ chối mọi 
giá trị ngoài danh sách này. Đồng thời, thực hiện kiểm tra và lọc dữ liệu 
đầu vào phía server.

Ngoài ra, ứng dụng nên ẩn thông báo lỗi chi tiết từ CSDL và chỉ trả về 
thông báo chung cho người dùng, nhằm tránh lộ thông tin hỗ trợ khai thác.

\subsection{Tham chiếu:}
OWASP Web Security Testing Guide - WSTG-INPV-05: Testing for SQL Injection

\section{Lỗ hổng HTTP Request smuggling}

\subsection{Đánh giá rủi ro bảo mật: Cao}

Dựa trên phương pháp OWASP Risk Rating, lỗ hổng HTTP Request 
Smuggling được đánh giá với hệ số khả năng khai thác là 
4.750 và hệ số tác động là 6.50. Kết quả cho thấy lỗ hổng 
có khả năng bị khai thác trung bình và mức độ tác động ở mức cao 
bình, do đó mức độ rủi ro tổng thể của lỗ hổng được xác định 
ở mức Cao.

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/Capture7.png}
\caption{Đánh giá rủi ro bảo mật cho lỗ hổng HTTP Request Smuggling}
\label{fig:Capture7}
\end{figure}

\subsection{Mô tả}

Hệ thống tồn tại lỗ hổng HTTP Request Smuggling do sự không thống nhất trong 
cách xử lý các header Content-Length và Transfer-Encoding giữa Front-End server 
và Back-End server. Trong khi Front-End server xác định độ dài request dựa trên 
Content-Length, Back-End server lại ưu tiên xử lý theo Transfer-Encoding: 
chunked. Sự khác biệt này cho phép kẻ tấn công chèn thêm một request ẩn phía 
sau request hợp lệ trong cùng một kết nối TCP.

\subsection{Tác động}

Lỗ hổng HTTP Request Smuggling cho phép kẻ tấn công can thiệp vào quá 
trình xử lý request của những người dùng khác trên cùng kết nối. Thông 
qua việc chèn request ẩn, kẻ tấn công có thể chiếm quyền điều khiển luồng 
request tiếp theo được gửi đến Back-End server, từ đó thu thập được toàn bộ 
nội dung request của nạn nhân, bao gồm cả cookie phiên đăng nhập.

\subsection{Tái hiện}

Một request hợp lệ tới trang chủ được ghi nhận, 
trong đó server chấp nhận phương thức POST và sử dụng header 
Transfer-Encoding: chunked. Đây là điều kiện cần để tiến hành 
thử nghiệm HTTP Request Smuggling.

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image32.png}
\caption{Server chấp nhận phương thức POST với Transfer-Encoding: chunked}
\label{fig:image32}
\end{figure}

Chèn payload gây lỗi phía sau gọi tới 1 trang 404 đồng thời gửi cùng với 
1 yêu cầu bình thường (gửi trong cùng 1 kết nối tcp để tái hiện nạn nhân 
sẽ gửi request ngay sau)

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image34.png}
\caption{Gửi request độc hại chứa payload HTTP Request Smuggling}
\label{fig:image34}
\end{figure}

Khi request độc hại được gửi đến, Front-End server xử lý nội dung dựa trên header Content-Length và chuyển phần body sang Back-End server. Trong khi đó, Back-End server lại phân tích request theo header Transfer-Encoding: chunked và dừng xử lý tại ký tự kết thúc chunk (0), khiến phần dữ liệu phía sau không bị loại bỏ mà được giữ lại trong bộ đệm. Khi một request hợp lệ khác được gửi trên cùng kết nối TCP, dữ liệu này sẽ được ghép vào request mới và tiếp tục được xử lý, dẫn đến phản hồi lỗi 404 Not Found, qua đó xác nhận sự tồn tại của lỗ hổng HTTP Request Smuggling loại CL-TE.

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image36.png}
\caption{Request bình thường gửi ngay sau đó}
\label{fig:image36}
\end{figure}

Tiếp tục khai thác sâu hơn, lỗ hổng HTTP Request Smuggling cho phép kẻ tấn công thu thập thông tin phiên làm việc của request hợp lệ được gửi ngay sau request độc hại trên cùng một kết nối TCP. Thông qua việc kiểm soát cách Front-End và Back-End server diễn giải request, dữ liệu của request tiếp theo có thể bị ghép và xử lý ngoài dự kiến, từ đó làm lộ các thông tin nhạy cảm liên quan đến phiên người dùng.

Để thực hiện kịch bản khai thác này, cần xác định một request sử dụng phương thức POST và có khả năng ghi nhận hoặc lưu trữ dữ liệu do người dùng cung cấp. Trong quá trình kiểm thử, chức năng cập nhật thông tin cá nhân của người dùng đáp ứng được yêu cầu này do tiếp nhận dữ liệu đầu vào và xử lý trực tiếp ở phía máy chủ. Việc lợi dụng chức năng này cho phép kẻ tấn công thu thập hoặc thao túng dữ liệu của request kế tiếp, qua đó mở rộng phạm vi ảnh hưởng của lỗ hổng HTTP Request Smuggling:
\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image37.png}
\caption{Chức năng cập nhật thông tin cá nhân người dùng}
\label{fig:image37}
\end{figure}

Sau khi thực hiện cập nhật thông tin cá nhân, quan sát Burp Suite bắt
được request như sau:

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image38.png}
\caption{Chức năng cập nhật thông tin cá nhân người dùng}
\label{fig:image38}
\end{figure}

Payload được đưa xuống cuối nội dung của yêu cầu để khi yêu cầu 
tiếp theo gửi đến bị nối vào, dữ liệu của request này sẽ được hệ thống lưu 
và hiên thị 
trực tiếp trong trường Description (Mô tả):

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image39.png}
\caption{Payload chèn vào cuối request cập nhật thông tin cá nhân}
\label{fig:image39}
\end{figure}

Nối request này vào request độc hại ban đầu:

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image40.png}
\caption{Nối request vào request độc hại ban đầu}
\label{fig:image40}
\end{figure}

Content-Length của request thứ nhất được đặt đủ lớn để bao phủ toàn 
bộ payload. Content-Length của request được nối phía sau được điều 
chỉnh để cho phép dữ liệu của request tiếp theo được ghép vào và được 
hệ thống xử lý như giá trị của biến description\_editor\%5Btext\%5D . Nhờ đó, nội 
dung của request sau được lưu trực tiếp vào trường Description trên 
trang web.

Khi một người dùng khác gửi request bất kỳ tới hệ thống, request 
của họ sẽ bị nối vào phía sau request độc hại do kẻ tấn công tạo ra. 
Kết quả là toàn bộ nội dung request của nạn nhân, bao gồm cả thông tin 
phiên đăng nhập, được hệ thống hiển thị và lưu lại trong trường 
Description trên giao diện của kẻ tấn công.

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image43-1.png}
\caption{Request của nạn nhân bị nối vào và hiển thị trên giao diện kẻ tấn công}
\label{fig:image43}
\end{figure}


\subsection{Vị trí}

\begin{longtable}{|>{\centering\arraybackslash}p{0.5cm}|>{\centering\arraybackslash}p{3cm}|>{\centering\arraybackslash}p{10.5cm}|}
\caption{Danh sách đường dẫn được ghi nhận cho lỗ hổng HTTP Request Smuggling}\\
\hline
\textbf{\#} & \textbf{Phương thức} & \textbf{Đường dẫn} \\
\hline
\endfirsthead

\hline
\textbf{\#} & \textbf{Phương thức} & \textbf{Đường dẫn} \\
\hline
\endhead

1 & POST & https://lms.hust.edu.vn/ \\ \hline

\end{longtable}



\subsection{Phương án khắc phục}

Để khắc phục lỗ hổng HTTP Request Smuggling, hệ thống cần đảm bảo sự thống nhất trong cách xử lý HTTP request giữa Front-End và Back-End server. Server phải được cấu hình để chỉ chấp nhận một cơ chế xác định độ dài request và không cho phép đồng thời tồn tại hai header Content-Length và Transfer-Encoding trong cùng một yêu cầu, nhằm tránh sự khác biệt trong quá trình phân tích request. Ngoài ra, các request có cấu trúc bất thường hoặc không tuân thủ chuẩn HTTP cần được từ chối ngay từ phía máy chủ để giảm thiểu nguy cơ bị khai thác.

\subsection{Tham chiếu:} 
OWASP Web Security Testing Guide - WSTG-INPV-15: Testing for HTTP Splitting Smuggling


\section{Hỗ trợ thuật toán mã hóa yếu trong TLS 1.2}

\subsection{Đánh giá rủi ro bảo mật: Thấp}

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/Capture8.png}
\caption{Cookie của người dùng không có cờ HttpOnly: true}
\label{fig:Capture8}
\end{figure}

\subsection{Mô tả}

Ứng dụng được phát hiện đang cấu hình cho phép sử dụng một số thuật toán 
và bộ mã hóa TLS yếu hoặc đã lỗi thời trong quá trình thiết lập kết nối 
HTTPS giữa máy khách và máy chủ. 

\subsection{Tác động}

Việc sử dụng các bộ mã hóa TLS yếu làm giảm mức độ an toàn của kênh truyền dữ liệu giữa client và server. Trong một số trường hợp, kẻ tấn công có thể lợi dụng các điểm yếu của thuật toán mã hóa để phân tích hoặc giải mã dữ liệu truyền tải, từ đó làm tăng nguy cơ rò rỉ các thông tin nhạy cảm như thông tin xác thực, dữ liệu người dùng hoặc token phiên làm việc.

Ngoài ra, cấu hình TLS không an toàn còn có thể tạo điều kiện cho các hình thức tấn công trung gian (Man-in-the-Middle), đặc biệt khi hệ thống được truy cập từ các môi trường mạng công cộng. Bên cạnh đó, việc sử dụng các bộ mã hóa yếu khiến cơ chế bảo mật TLS của hệ thống không đáp ứng các khuyến nghị và tiêu chuẩn bảo mật hiện hành (ví dụ như OWASP hoặc Mozilla TLS Guide), từ đó có thể ảnh hưởng đến yêu cầu tuân thủ các tiêu chuẩn an toàn thông tin trong môi trường triển khai thực tế.

\subsection{Tái hiện}

Kết quả kiểm tra cấu hình SSL/TLS của máy chủ bằng công cụ SSL Labs cho thấy hệ thống vẫn hỗ trợ nhiều 
TLS 1.2 cipher suites bị đánh giá là yếu (WEAK). Các cipher này vẫn được sử dụng trong quá trình thiết 
lập kết nối TLS giữa máy khách và máy chủ, cho thấy cấu hình hiện tại chưa loại bỏ các thuật toán mã 
hóa TLS 1.2 không còn được khuyến nghị theo các tiêu chuẩn bảo mật hiện hành.

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{Hinhve/image29.png}
\caption{TLS 1.2 hỗ trợ các thuật toán mã hóa yếu}
\label{fig:image29}
\end{figure}



\subsection{Vị trí}

\begin{longtable}{|>{\centering\arraybackslash}p{0.5cm}|>{\centering\arraybackslash}p{3cm}|>{\centering\arraybackslash}p{10.5cm}|}
\caption{Danh sách đường dẫn được ghi nhận cho hỗ trợ thuật toán mã hóa yếu trong TLS 1.2}\\
\hline
\textbf{\#} & \textbf{Phương thức} & \textbf{Đường dẫn} \\
\hline
\endfirsthead

\hline
\textbf{\#} & \textbf{Phương thức} & \textbf{Đường dẫn} \\
\hline
\endhead

1 & GET & https://lms.hust.edu.vn/ \\ \hline

\end{longtable}

\subsection{Phương án khắc phục}

Cần vô hiệu hóa toàn bộ các bộ mã hóa TLS yếu, đồng thời chỉ cho phép sử dụng các bộ mã hóa 
mạnh được khuyến nghị theo các tiêu chuẩn bảo mật hiện hành.

\subsection{Tham chiếu:} 
OWASP Web Security Testing Guide - WSTG-CRYP-01: Testing for Weak Transport Layer Security


\end{document}